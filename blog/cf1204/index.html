<!DOCTYPE html><html> <head><meta charset="UTF-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.1.1"><title>CodeForces Round #581 Div2 题解</title><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&display=swap"><!-- Matomo --><script>
      var _paq = (window._paq = window._paq || []);
      _paq.push(["trackPageView"]);
      _paq.push(["enableLinkTracking"]);
      (function () {
        var u = "//analytics.skywt.cn/";
        _paq.push(["setTrackerUrl", u + "matomo.php"]);
        _paq.push(["setSiteId", "1"]);
        var d = document,
          g = d.createElement("script"),
          s = d.getElementsByTagName("script")[0];
        g.async = true;
        g.src = u + "matomo.js";
        s.parentNode.insertBefore(g, s);
      })();
    </script><!-- End Matomo Code --><link rel="stylesheet" href="/_astro/about.4DFoe-cT.css" />
<style>img[data-astro-cid-4sn4zg3r]{border-radius:.25rem;--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}
</style>
<link rel="stylesheet" href="/_astro/friends.CELmKF_Q.css" /></head> <body> <header class="mt-12 wide-container" data-astro-cid-3ef6ksr2> <h5 class="mt-4 mx-4 secondary-color sm:hidden text-center" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> 博客</a> </span><span>
/
CodeForces Round #581 Div2 题解 </span> </h5> </header> <nav class="py-2 font-thin sticky top-0 backdrop-blur-md z-10 transition-all" id="navbar-wrapper" data-astro-cid-3ef6ksr2> <div class="wide-container flex justify-center sm:justify-between flex-wrap" data-astro-cid-3ef6ksr2> <h5 class="m-2 hidden sm:block secondary-color" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> 博客</a> </span><span>
/
CodeForces Round #581 Div2 题解 </span> </h5> <div class="m-2 secondary-color" data-astro-cid-3ef6ksr2> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> <i class="ri-home-line" data-astro-cid-tfcnbjmv></i>
主页
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv> <i class="ri-newspaper-line" data-astro-cid-tfcnbjmv></i> 博客 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv> <i class="ri-server-line" data-astro-cid-tfcnbjmv></i> 实验室 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv> <i class="ri-contacts-line" data-astro-cid-tfcnbjmv></i> 友人 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv> <i class="ri-cup-line" data-astro-cid-tfcnbjmv></i> 关于 </a> </li> </ul>  </div> </div> </nav> <script>
  const headerEl = document.querySelector("#navbar-wrapper");
  const sentinalEl = document.querySelector("header");
  const handler = (entries) => {
    if (!entries[0].isIntersecting) {
      headerEl.classList.add("sticked");
    } else {
      headerEl.classList.remove("sticked");
    }
  };
  const observer = new window.IntersectionObserver(handler);
  observer.observe(sentinalEl);
</script>   <main data-astro-cid-4sn4zg3r> <section class="container mt-32" data-astro-cid-4sn4zg3r>  <h1 class="primary-color leading-relaxed" data-astro-cid-4sn4zg3r>CodeForces Round #581 Div2 题解</h1> <p class="mt-4 secondary-color leading-relaxed" data-astro-cid-4sn4zg3r> <i class="ri-calendar-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>2019 年 09 月 30 日</span>   <br data-astro-cid-4sn4zg3r> <i class="ri-discuss-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>共 0 条评论</span>  </p> <hr class="my-8" data-astro-cid-4sn4zg3r> <p class="card p-2 my-8" data-astro-cid-4sn4zg3r>
⚙️ 全新博客前端仍在测试中。如果文章显示不正常，可以尝试访问<a href="https://blog.skywt.cn/posts/cf1204" class="link underline" data-astro-cid-4sn4zg3r>原博客的这篇文章</a>。
</p> <article class="prose dark:prose-neutral dark:prose-invert max-w-none" data-astro-cid-4sn4zg3r> <p>Codeforces Round #581 (Div. 2) 比赛链接：<a href="https://codeforces.com/contest/1204/">LInk</a></p><h1>C - Anna, Svyatoslav and Maps</h1><h2>Description</h2><p>给出一张有向图，每条边的边权都是 1。给出一个 m 个点的路径序列 $\{p_i \}$，表示依次经过这 m 个点的路径。路径序列中相邻元素之间有边相连。<br>现在需要你找出这个序列的一个<strong>最短的</strong>子序列 $\{v_i \}$，长度为 k，使得经过这 k 个点的路径也经过 $\{p_i \}$ 中所有点。</p><!--more--><p>（难以描述……）</p><blockquote>Define the sequence $v_1,v_2,\dots,v_k$ of $k$ vertexes as good, if $v$ is a subsequence of $p$, $v_1=p_1$, $v_k=p_m$, and $p$ is one of the shortest paths passing through the vertexes $v_1 ,\dots, v_k$ in that order.</blockquote><p>（题目里说是无环的，但是给出数据包括样例都是有环的……没搞懂……）</p><p>数据范围：$2\leq n\leq 100, 2\leq m\leq 10^6$。</p><h2>Solution #1</h2><p>VP 的时候写出来的，但是数组开小了 qwq 一直显示 WA 但是一直找不到错……</p><p>翻译一下题意无非就是让我们找“不必要的点”，即在路径中删除之后根据之前和之后的点能推断出的点。既然走的是最短路，能删除的点自然是在最短路径上的点。<br>看到百级的数据肯定先跑 Floyd，然后遍历题中的路径。答案序列初始只有 <code>p[1]</code>，记答案序列最后一个元素是 <code>last</code>，则对于每个元素只要判断是否在最短路上即可：</p><p>$$dist(last,p_{i+1}) == dist(last,p_i) + dist(p_i,p_{i+1})$$</p><h2>Code #1</h2><pre><code class="lang-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;
 
inline int read(){
    int ret=0,f=1;char ch=getchar();
    while (ch&lt;'0'||ch&gt;'9') {if (ch=='-') f=-1;ch=getchar();}
    while (ch&gt;='0'&amp;&amp;ch&lt;='9') ret=ret*10+ch-'0',ch=getchar();
    return ret*f;
}
 
const int INF=0x3f3f3f3f;
 
const int maxn=105;
const int maxm=1000005;
 
int n,m;
int dist[maxn][maxn];
 
int p[maxm];
vector&lt;int&gt; ans;
 
void Floyd(){
    for (int k=1;k&lt;=n;k++)
        for (int i=1;i&lt;=n;i++)
            for (int j=1;j&lt;=n;j++)
                dist[i][j]=min(dist[i][j],dist[i][k]+dist[k][j]);
}
 
signed main(){
    n=read();
    memset(dist,0x3f,sizeof(dist));
    for (int i=1;i&lt;=n;i++) dist[i][i]=0;
    
    char ch=getchar(); while (ch!='0'&amp;&amp;ch!='1') ch=getchar();
    for (int i=1;i&lt;=n;i++)
        for (int j=1;j&lt;=n;j++){
            if (ch=='1') dist[i][j]=1;
            if (i==n&amp;&amp;j==n) continue;
            ch=getchar(); while (ch!='0'&amp;&amp;ch!='1') ch=getchar();
        }
    m=read();
    for (int i=1;i&lt;=m;i++) p[i]=read();
 
    Floyd();
    int last=-1;
    for (int i=1;i&lt;=m;i++){
        if (i==1 || i==m) {
            ans.push_back(p[i]);last=p[i];
            continue;
        }
        if (dist[last][p[i+1]] == dist[last][p[i]]+dist[p[i]][p[i+1]]){continue;}
        ans.push_back(p[i]);last=p[i];
    }
    printf(&quot;%d\n&quot;,(int)ans.size());
    for (int i=0;i&lt;(int)ans.size();i++) printf(&quot;%d &quot;,ans[i]);
    printf(&quot;\n&quot;);
    return 0;
}</code></pre><h2>Solution #2</h2><p>（来自 CF 官方 Tutorial）</p><p>先跑 Floyd（或者 DFS……），一样先把 $p_1$ 加入答案，然后遍历 $p$ 路径时记录 last 到当前的路径长度（因为题目中保证 $p$ 的相邻元素之间有边），如果 $dist(last,p_i)$ 小于记录的路径长度，说明 last 到这个点有其他更短的路径，则必须在答案序列加入 $p_{i-1}$ 以确保沿 $p$ 路径走。</p><h2>Code #2</h2><pre><code class="lang-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;

inline int read(){
    int ret=0,f=1;char ch=getchar();
    while (ch&lt;'0'||ch&gt;'9') {if (ch=='-') f=-1;ch=getchar();}
    while (ch&gt;='0'&amp;&amp;ch&lt;='9') ret=ret*10+ch-'0',ch=getchar();
    return ret*f;
}

const int INF=0x3f3f3f3f;

const int maxn=105;
const int maxm=1e6+5;

int n,m;
int dist[maxn][maxn];

int p[maxm];
vector&lt;int&gt; ans;

void Floyd(){
    for (int k=1;k&lt;=n;k++)
        for (int i=1;i&lt;=n;i++)
            for (int j=1;j&lt;=n;j++)
                dist[i][j]=min(dist[i][j],dist[i][k]+dist[k][j]);
}

signed main(){
    n=read();
    memset(dist,0x3f,sizeof(dist));
    for (int i=1;i&lt;=n;i++) dist[i][i]=0;
    
    char ch=getchar(); while (ch!='0'&amp;&amp;ch!='1') ch=getchar();
    for (int i=1;i&lt;=n;i++)
        for (int j=1;j&lt;=n;j++){
            if (ch=='1') dist[i][j]=1;
            if (i==n&amp;&amp;j==n) continue;
            ch=getchar(); while (ch!='0'&amp;&amp;ch!='1') ch=getchar();
        }
    m=read();
    for (int i=1;i&lt;=m;i++) p[i]=read();

    Floyd();
    int last,cnt;
    for (int i=1;i&lt;=m;i++){
        cnt++;
        if (i==1) {
            ans.push_back(p[i]);last=p[i];cnt=0;
        } else if (i!=2 &amp;&amp; dist[last][p[i]] &lt; cnt){
            ans.push_back(p[i-1]);
            last=p[i-1];cnt=1;
        }
    }
    ans.push_back(p[m]);
    printf(&quot;%d\n&quot;,(int)ans.size());
    for (int i=0;i&lt;(int)ans.size();i++) printf(&quot;%d &quot;,ans[i]);
    printf(&quot;\n&quot;);
    return 0;
}</code></pre><h1>D1/D2 -  Kirk and a Binary String</h1><h2>Description</h2><p>给出一个长度为 n 的 0/1 串 s，你需要找出一个长度相同的 0/1 串 t，满足：</p><ul><li>对于任意 $l$ 和 $r$（$1\leq l \leq r\leq n$），满足 $[l,r]$ 区间之内两个串的最长非降子序列（LIS）长度相等；</li><li>t 串中 <code>0</code> 尽量多。</li></ul><p>数据范围：$n\leq 2000$。</p><h2>Solution #1</h2><p>（来自 <a href="https://blog.csdn.net/nudt_spy/article/details/99940916">https://blog.csdn.net/nudt_spy/article/details/99940916</a>）</p><p>从后向前考虑：</p><ul><li>对于 <code>0</code>：必然是某个 LIS 的一部分，如果改为 <code>1</code>，必然会缩短 LIS 的长度（1）；</li><li><p>对于 <code>1</code>：</p><ul><li>如果以它为起点的区间的 LIS 包含它（显然这个区间的 LIS 全是 <code>1</code>），则把它修改为 0 没有变化（2）；</li><li>如果以它为起点的区间的 LIS 不包含它，则把它改为 <code>0</code> 会增加 LIS 长度（3）；</li></ul></li></ul><p>所以只有第（2）种情况可以修改。如果某个区间的 LIS 全是 <code>1</code>，则这个区间必然是 <code>1</code> 的数量大于 <code>0</code> 的数量，并且 <code>1</code> 开头。所以只要从后往前统计，如果 <code>1</code> 的数量大于等于 <code>0</code> 的数量，则允许将 <code>1</code> 改为 <code>0</code>。</p><p>（为什么不考虑形如 <code>10001111</code> 的数列？（这个数列里 LIS 似乎并不是第二种情况）在从后向前处理时，后面的 <code>1</code> 都会被搞成 <code>0</code>，换句话说最终 LIS 全是 <code>0</code> 或者全是 <code>1</code>）</p><h2>Solution #2</h2><p>（来自 CF 官方 Tutorial）</p><p>如果对于一个 0/1 串 $p$，没有串与它满足条件一，则称这个串为 fixed 串。则有以下几条事实：</p><ul><li><code>10</code> 是 fixed 的；</li><li>如果 $p$ 和 $q$ 都是 fixed 的，则 $pq$ 也是 fixed 的；</li><li>如果 $p$ 是 fixed 的，那么 $1p0$ 也是 fixed 的；</li><li>每个 fixed 串的 <code>0</code> 和 <code>1</code> 数量相等；</li><li>每个 fixed 串的 LIS 长度都是其一半，并且只包含 <code>0</code> 或者只包含 <code>1</code>；</li></ul><p>（证明可见：<a href="https://www.cnblogs.com/yyf0309/p/11389504.html">https://www.cnblogs.com/yyf0309/p/11389504.html</a>）</p><p>那么对于题目中所给的 s，其中的若干 fixed 串是不能改变的，可以不考虑；<br>则剩下的部分都是一段段 LIS（否则就会有 <code>10</code> 即 fixed string）。所以只要剩下的部分把 <code>1</code> 改成 <code>0</code>，各个 LIS 都不会改变。</p><h2>Code #2</h2><pre><code class="lang-cpp">#include&lt;bits/stdc++.h&gt;

using namespace std;

inline int read(){
    int ret=0,f=1;char ch=getchar();
    while (ch&lt;'0'||ch&gt;'9') {if (ch=='-') f=-1;ch=getchar();}
    while (ch&gt;='0'&amp;&amp;ch&lt;='9') ret=ret*10+ch-'0',ch=getchar();
    return ret*f;
}

const int maxn=100005;

int n;
char s[maxn];
bool vis[maxn];

signed main(){
    scanf(&quot;%s&quot;,s+1); n=strlen(s+1);
    for (int i=1;i&lt;=n;i++) if (i!=1 &amp;&amp; s[i-1]=='1' &amp;&amp; s[i]=='0'){
        int l=i-1,r=i; vis[l]=vis[r]=true;
        while (l-1&gt;=1&amp;&amp;s[l-1]=='1' &amp;&amp; r+1&lt;=n&amp;&amp;s[r+1]=='0') l--,r++,vis[l]=vis[r]=true;
        for (;;){
            if (l-1&gt;=1 &amp;&amp; vis[l-1]){
                while (l-1&gt;=1 &amp;&amp; vis[l-1]) l--;
                while (l-1&gt;=1&amp;&amp;s[l-1]=='1' &amp;&amp; r+1&lt;=n&amp;&amp;s[r+1]=='0') l--,r++,vis[l]=vis[r]=true;
            } else break;
        }
        i=r;
    }
    for (int i=1;i&lt;=n;i++) if ((!vis[i]) &amp;&amp; s[i]=='1') s[i]='0';
    printf(&quot;%s\n&quot;,s+1);
    return 0;
}</code></pre><h1>1204E - Natasha, Sasha and the Prefix Sums</h1><h2>Description</h2><p>给出 $n$ 和 $m$，对于每个长度为 $n+m$、包含 $n$ 个 1、$m$ 个 -1 的数列，有其最大的前缀和（如果小于 0 则取 0）。形式化地说，定义 $f(a)$ 为长度为 $l$ 的序列 $a_1,\dots,a_l$ 的最大前缀和，$l \geq 0$，则：</p><p>$$f(a) = \max (0, \smash{\displaystyle\max_{1 \leq i \leq l}} \sum_{j=1}^{i} a_j )$$</p><p>需要求出对于所有这样的数列，最大前缀和之和。模 998244853。</p><p>数据范围：$0\leq n,m\leq 2000$。</p><h2>Solution</h2><p>（来自 CF 官方 Tutorial）</p><p>首先构造一个 DP 数组 $G(i,j)$，表示 $n-i,m=j$ 时最大前缀和是 0 的数组数量。</p><ul><li>$i=0$ 时：显然 $G(i,j)=1$；</li><li>$i&gt;j$ 时：$G(i,j)=0$；</li><li>其他情况：可以从 $G(i-1,j)$ 中转移：直接在最后加上一个 1，原来最大前缀和是 0 的现在还是 0（因为 $x\leq y$），$G(i,j-1)$ 同理。<br>所以：$G(i,j)=G(i-1,j)+G(i,j-1)$；<br>这个数组的构造可以解决 “前缀和小于 0 时取 0” 的问题。</li></ul><p>定义 $F(i,j)$ 表示 $n=i,m=j$ 时的答案（最大前缀和之和）。</p><ul><li>$i=0$ 时：显然 $F(i,j)=0$；</li><li>$j=0$ 时：显然 $F(i,j)=i$；</li><li>考虑对于 $(i-1,j)$ 的数列：在前面加上一个 1 就可以变成 $i,j$，这样的数列有 ${x+y-1 \choose x}$ 个，则这一部分答案是 ${i+j-1 \choose j} + F(x-1,y)$；同样地，对于 $(i,j-1)$ 的数列有 ${i+j-1 \choose i} - G(i,j-1)$ 个（为 0 的不能再减），每个减去一个 1，这部分答案是 $F(i,j-1)-({i+j-1 \choose i} - G(i,j-1))$。</li></ul><p>$$F(i,j)={i+j-1 \choose j} + F(x-1,y) + F(i,j-1)-({i+j-1 \choose i} - G(i,j-1))$$</p><h2>Code</h2><pre><code class="lang-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;

#define int long long

inline int read(){
    int ret=0,f=1;char ch=getchar();
    while (ch&lt;'0'||ch&gt;'9') {if (ch=='-') f=-1;ch=getchar();}
    while (ch&gt;='0'&amp;&amp;ch&lt;='9') ret=ret*10+ch-'0',ch=getchar();
    return ret*f;
}

const int tt=998244853;
const int maxn=2005;

int n,m;
int f[maxn][maxn],g[maxn][maxn];
int c[maxn*2][maxn*2];

void build_cons(){
    c[1][0]=c[1][1]=1;
    for (int i=2;i&lt;=n+m;i++){
        c[i][0]=c[i][i]=1;
        for (int j=1;j&lt;i;j++) c[i][j]=(c[i-1][j-1]+c[i-1][j])%tt;
    }
}

signed main(){
    n=read(); m=read();

    for (int i=0;i&lt;=n;i++)
        for (int j=0;j&lt;=m;j++){
            if (i==0) g[i][j]=1; else
            if (i&gt;j) g[i][j]=0; else
            g[i][j]=(g[i-1][j]+g[i][j-1])%tt;
        }

    build_cons();
    
    for (int i=0;i&lt;=n;i++)
        for (int j=0;j&lt;=m;j++){
            if (i==0) f[i][j]=0; else
            if (j==0) f[i][j]=i; else
            f[i][j]=((c[i+j-1][j]+f[i-1][j])%tt+(f[i][j-1]-(c[i+j-1][i]-g[i][j-1])%tt+tt)%tt)%tt;
        }

    printf(&quot;%lld\n&quot;,f[n][m]);
    return 0;
}</code></pre> </article> <hr class="my-8" data-astro-cid-4sn4zg3r> <h2> <i class="ri-discuss-line"></i> 共 0 条评论 </h2>  <hr class="my-8"> <h2> <i class="ri-discuss-line"></i>
发表评论
</h2> <p class="primary-color card my-4 p-2">
🚧 新博客系统的评论功能仍在开发中，敬请期待。可以前往<a href="https://blog.skywt.cn/posts/cf1204" class="link underline">原博客的这篇文章</a>底部评论区发表评论。
</p> </section> </main>  <footer class="mt-16 py-8 bg-gray-100 dark:bg-neutral-900"> <div class="wide-container secondary-color text-sm"> <div class="m-2 flex justify-between flex-wrap"> <div class="m-2"> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> 博客</a> </span><span>
/
CodeForces Round #581 Div2 题解 </span> </div> <div class="m-2"> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> 
主页
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv>  博客 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv>  实验室 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv>  友人 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv>  关于 </a> </li> </ul>  </div> </div> <hr> <div class="m-2 flex justify-between flex-wrap"> <p class="m-2">
&#169; 2017-2024 <a href="https://skywt.cn/" class="link">SkyWT</a> /
<a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33080202000472" target="_blank" class="link before:content-[url('/mps.png')] before:align-middle">
浙公网安备33080202000472号</a> /
<a href="https://beian.miit.gov.cn/" target="_blank" class="link">
浙ICP备2021019606号-1
</a> </p> <div class="m-2"> <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" class="inline-block mx-1" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/cc.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/by.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/nc.svg" data-astro-cid-h3ykra2n>   </a>  <a href="https://notbyai.fyi" target="_blank" class="inline-block mx-1" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-light.svg" alt="Not By AI Badge" class="badge inline-block dark:hidden" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-dark.svg" alt="Not By AI Badge" class="badge hidden dark:inline-block" data-astro-cid-hwbnc4sm> </a>  <a href="https://www.foreverblog.cn/" target="_blank" class="inline-block mx-1"> <img src="https://img.foreverblog.cn/logo_en_default.png" alt="Forever Blog Badage" class="inline-block h-4 grayscale"> </a> </div> </div> </div> </footer> </body></html> 