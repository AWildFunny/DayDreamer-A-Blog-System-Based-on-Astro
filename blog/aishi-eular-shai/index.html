<!DOCTYPE html><html> <head><meta charset="UTF-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.1.1"><title>埃氏筛法（朴素筛法及其优化）与欧拉筛（线性筛法）略解</title><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&display=swap"><!-- Matomo --><script>
      var _paq = (window._paq = window._paq || []);
      _paq.push(["trackPageView"]);
      _paq.push(["enableLinkTracking"]);
      (function () {
        var u = "//analytics.skywt.cn/";
        _paq.push(["setTrackerUrl", u + "matomo.php"]);
        _paq.push(["setSiteId", "1"]);
        var d = document,
          g = d.createElement("script"),
          s = d.getElementsByTagName("script")[0];
        g.async = true;
        g.src = u + "matomo.js";
        s.parentNode.insertBefore(g, s);
      })();
    </script><!-- End Matomo Code --><link rel="stylesheet" href="/_astro/about.42xRgEnE.css" />
<style>img[data-astro-cid-4sn4zg3r]{border-radius:.25rem;--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}
</style>
<link rel="stylesheet" href="/_astro/friends.hRKOKN_Z.css" /></head> <body> <header class="mt-12 wide-container" data-astro-cid-3ef6ksr2> <h5 class="mt-4 mx-4 secondary-color sm:hidden text-center" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> 博客</a> </span><span>
/
埃氏筛法（朴素筛法及其优化）与欧拉筛（线性筛法）略解 </span> </h5> </header> <nav class="py-2 font-thin sticky top-0 backdrop-blur-md z-10 transition-all" id="navbar-wrapper" data-astro-cid-3ef6ksr2> <div class="wide-container flex justify-center sm:justify-between flex-wrap" data-astro-cid-3ef6ksr2> <h5 class="m-2 hidden sm:block secondary-color" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> 博客</a> </span><span>
/
埃氏筛法（朴素筛法及其优化）与欧拉筛（线性筛法）略解 </span> </h5> <div class="m-2 secondary-color" data-astro-cid-3ef6ksr2> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> <i class="ri-home-line" data-astro-cid-tfcnbjmv></i>
主页
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv> <i class="ri-newspaper-line" data-astro-cid-tfcnbjmv></i> 博客 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv> <i class="ri-server-line" data-astro-cid-tfcnbjmv></i> 实验室 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv> <i class="ri-contacts-line" data-astro-cid-tfcnbjmv></i> 友人 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv> <i class="ri-cup-line" data-astro-cid-tfcnbjmv></i> 关于 </a> </li> </ul>  </div> </div> </nav> <script>
  const headerEl = document.querySelector("#navbar-wrapper");
  const sentinalEl = document.querySelector("header");
  const handler = (entries) => {
    if (!entries[0].isIntersecting) {
      headerEl.classList.add("sticked");
    } else {
      headerEl.classList.remove("sticked");
    }
  };
  const observer = new window.IntersectionObserver(handler);
  observer.observe(sentinalEl);
</script>   <main data-astro-cid-4sn4zg3r> <section class="container mt-32" data-astro-cid-4sn4zg3r>  <h1 class="primary-color leading-relaxed" data-astro-cid-4sn4zg3r>埃氏筛法（朴素筛法及其优化）与欧拉筛（线性筛法）略解</h1> <p class="mt-4 secondary-color leading-relaxed" data-astro-cid-4sn4zg3r> <i class="ri-calendar-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>2018 年 08 月 09 日</span>   <br data-astro-cid-4sn4zg3r> <i class="ri-discuss-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>共 2 条评论</span>  </p> <hr class="my-8" data-astro-cid-4sn4zg3r> <p class="card p-2 my-8" data-astro-cid-4sn4zg3r>
⚙️ 全新博客前端仍在测试中。如果文章显示不正常，可以尝试访问<a href="https://blog.skywt.cn/posts/aishi-eular-shai" class="link underline" data-astro-cid-4sn4zg3r>原博客的这篇文章</a>。
</p> <article class="prose dark:prose-neutral dark:prose-invert max-w-none" data-astro-cid-4sn4zg3r> <p>在之前我们学过的最朴素的筛法就是<strong>埃氏筛法</strong>（埃拉托斯特尼筛法），它的复杂度是 $\Theta (N \log_2(N))$。其实这个朴素的筛法可以进行常数上的优化。还有一种更炫酷的筛法：欧拉筛，即线性筛法，时间复杂度为 $\Theta (N)$。</p><!--more--><h2>朴素筛法（埃氏筛法）</h2><p>之前我们很早就接触的筛法是这样的：</p><pre><code class="lang-cpp">for (int i=2;i&lt;=N;i++)
    for (int j=2;j&lt;=N/i;j++) vis[i*j]=false;</code></pre><p>另一种写法是：</p><pre><code class="lang-cpp">for (int i=2;i&lt;=N;i++)
    for (int j=i+i;j&lt;=N;j+=i) vis[j]=false;</code></pre><p>不得不说这个算法的确特别直观：把所有合数都筛掉。<a href="https://zh.wikipedia.org/wiki/%E5%9F%83%E6%8B%89%E6%89%98%E6%96%AF%E7%89%B9%E5%B0%BC%E7%AD%9B%E6%B3%95" title="维基百科上">维基百科上</a>还有个很形象的图（不得不说维基百科真是个好地方）：</p><p><img src="https://skywt.cn/wp-content/uploads/aaa.gif" alt=" title="维基百科上的图解"" title=" title="维基百科上的图解""></p><p>吐槽一句，这个筛法全名叫“埃拉托斯特尼筛法”……你知道为什么欧拉筛不叫欧氏筛法而只有这个筛法叫做埃氏筛法吗……</p><h3>时间复杂度</h3><p>可以看出，这个算法的计算量是 $\frac n 2 +\frac n 3 +\frac n 4 + \dots$。据说这个是调和级数，可以证明复杂度是 $\Theta (N log_2(N))$。</p><h3>朴素筛法的优化</h3><p>这个算法其实可以优化：按照原来的写法，对于合数 $a\ast b$，它会被 $a$ 和 $b$ 筛到，又会被 $b$ 和 $a$ 筛到，相当于被筛到了两次。其实我们可以只枚举较小的那个因子，这样可以优化一半的时间：</p><pre><code class="lang-cpp">for (int i=2;i&lt;=sqrt(n);i++)
    for (int j=i*i;j&lt;=n;j+=i) vis[j]=true;</code></pre><p>复杂度仍然没有优化，但是常数上优化了。</p><h2>线性筛法（欧拉筛）</h2><p>重头戏来了：利用欧拉筛，可以在线性时间内，即 $\Theta (N)$ 的复杂度筛出 1 到 N 的所有素数。</p><p>反思前面的代码，我们发现，其实很多合数被标了很多很多次，比如 $36=2\ast 18=3 \ast 12=4 \ast 9=6\ast 6$……能不能让所有素数都被筛到一次呢？<br>换一种思路，我们用 prime 数组记下所有素数。接下来枚举 prime 数组里的素数的倍数就可以了！</p><p>代码如下（这里我用 prime[0] 表示素数数量）：</p><pre><code class="lang-cpp">inline void BuildPrime(){
    vis[1]=false;
    for (int i=2;i&lt;=N;i++){
        if (vis[i]) prime[++prime[0]]=i;
        for (int j=1;j&lt;=prime[0];j++){
            if (i*prime[j]&gt;N) break;
            vis[i*prime[j]]=false;
            if (i%prime[j]==0) break; // 如果再往后，prime[j] 就不是 i*prime[j] 的最小质因子了，所以不需要继续了
        }
    }
}</code></pre><p>关键在于 <code>if (i%prime[j]==0) break</code> 这句，这是欧拉筛的精髓。我们只要当前 $prime[j]$ 是 $i\ast prime[j]$ 的最小质因子，再往后就不需要做了。</p> </article> <hr class="my-8" data-astro-cid-4sn4zg3r> <h2> <i class="ri-discuss-line"></i> 共 2 条评论 </h2> <div class="primary-color my-4"> <div class="flex items-center"> <img src="https://gravatar.com/avatar/bfd41aee7159214cadebf56b8e16e335" class="rounded-full w-12 mr-2"> <div class="m-2"> <h4>其惟春秋</h4> <p class="mt-1">2020 年 11 月 25 日 9:11</p> </div> </div> <p class="mt-2">哦哦，抱歉，网卡住了导致评论被吞？建议取消，谢谢你的这篇文章，对我的工作起到了极大的帮助。</p> <div class="ml-8">  </div> </div><div class="primary-color my-4"> <div class="flex items-center"> <img src="https://gravatar.com/avatar/bfd41aee7159214cadebf56b8e16e335" class="rounded-full w-12 mr-2"> <div class="m-2"> <h4>其惟春秋</h4> <p class="mt-1">2020 年 11 月 25 日 9:9</p> </div> </div> <p class="mt-2">一个建议，公开评论区，一定可以让你的博客变得更好。</p> <div class="ml-8">  </div> </div> <hr class="my-8"> <h2> <i class="ri-discuss-line"></i>
发表评论
</h2> <p class="primary-color card my-4 p-2">
🚧 新博客系统的评论功能仍在开发中，敬请期待。可以前往<a href="https://blog.skywt.cn/posts/aishi-eular-shai" class="link underline">原博客的这篇文章</a>底部评论区发表评论。
</p> </section> </main>  <footer class="mt-16 py-8 bg-gray-100 dark:bg-neutral-900"> <div class="wide-container secondary-color text-sm"> <div class="flex justify-between flex-wrap"> <div class="m-2"> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> 博客</a> </span><span>
/
埃氏筛法（朴素筛法及其优化）与欧拉筛（线性筛法）略解 </span> </div> <div class="m-2"> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> 
主页
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv>  博客 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv>  实验室 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv>  友人 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv>  关于 </a> </li> </ul>  </div> </div> <hr class="my-4"> <div class="flex justify-between flex-wrap"> <p class="m-2">
&#169; 2017-2024 <a href="/" class="link">SkyWT</a>
|
<a href="/sitemap.xml" class="link">站点地图</a>
|
<a href="/friends" class="link">友情链接</a>
|
<a href="https://foreverblog.cn/go.html" class="link">虫洞</a> <!-- |
        <a href="https://github.com/Skywt2003/Daydreamer" class="link"
          >Daydreamer</a
        > --> </p> <div class="m-2"> <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" class="inline-block mx-1" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/cc.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/by.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/nc.svg" data-astro-cid-h3ykra2n>   </a>  <a href="https://notbyai.fyi" target="_blank" class="inline-block mx-1" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-light.svg" alt="Not By AI Badge" class="badge inline-block dark:hidden" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-dark.svg" alt="Not By AI Badge" class="badge hidden dark:inline-block" data-astro-cid-hwbnc4sm> </a>  <a href="https://www.foreverblog.cn/" target="_blank" class="inline-block mx-1"> <img src="https://img.foreverblog.cn/logo_en_default.png" alt="Forever Blog Badage" class="inline-block h-4 grayscale"> </a> </div> </div> <div class="flex justify-between flex-wrap"> <p class="m-2"> <a href="https://beian.miit.gov.cn/" target="_blank" class="link">
浙 ICP 备 2021019606 号 - 1</a>
|
<a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33080202000472" target="_blank" class="link before:content-[url('/mps.png')] before:align-middle">
浙公网安备 33080202000472 号</a> </p> <p class="m-2"> <span class="align-middle">由</span> <a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" class="inline-block align-middle"> <img src="/upyun.png" class="h-6"> </a> <span class="align-middle">提供 CDN 加速、云存储服务</span> </p> </div> </div> </footer> </body></html> 