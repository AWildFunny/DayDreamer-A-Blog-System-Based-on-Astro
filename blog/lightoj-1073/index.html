<!DOCTYPE html><html> <head><meta charset="UTF-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.1.1"><title>LightOJ 1073 DNA Sequence 题解：字符串+状压 DP+字符串压位/搜索</title><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&display=swap"><!-- Matomo --><script>
      var _paq = (window._paq = window._paq || []);
      _paq.push(["trackPageView"]);
      _paq.push(["enableLinkTracking"]);
      (function () {
        var u = "//analytics.skywt.cn/";
        _paq.push(["setTrackerUrl", u + "matomo.php"]);
        _paq.push(["setSiteId", "1"]);
        var d = document,
          g = d.createElement("script"),
          s = d.getElementsByTagName("script")[0];
        g.async = true;
        g.src = u + "matomo.js";
        s.parentNode.insertBefore(g, s);
      })();
    </script><!-- End Matomo Code --><link rel="stylesheet" href="/_astro/about.42xRgEnE.css" />
<style>img[data-astro-cid-4sn4zg3r]{border-radius:.25rem;--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}
</style>
<link rel="stylesheet" href="/_astro/friends.hRKOKN_Z.css" /></head> <body> <header class="mt-12 wide-container" data-astro-cid-3ef6ksr2> <h5 class="mt-4 mx-4 secondary-color sm:hidden text-center" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> 博客</a> </span><span>
/
LightOJ 1073 DNA Sequence 题解：字符串+状压 DP+字符串压位/搜索 </span> </h5> </header> <nav class="py-2 font-thin sticky top-0 backdrop-blur-md z-10 transition-all" id="navbar-wrapper" data-astro-cid-3ef6ksr2> <div class="wide-container flex justify-center sm:justify-between flex-wrap" data-astro-cid-3ef6ksr2> <h5 class="m-2 hidden sm:block secondary-color" data-astro-cid-3ef6ksr2> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> 博客</a> </span><span>
/
LightOJ 1073 DNA Sequence 题解：字符串+状压 DP+字符串压位/搜索 </span> </h5> <div class="m-2 secondary-color" data-astro-cid-3ef6ksr2> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> <i class="ri-home-line" data-astro-cid-tfcnbjmv></i>
主页
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv> <i class="ri-newspaper-line" data-astro-cid-tfcnbjmv></i> 博客 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv> <i class="ri-server-line" data-astro-cid-tfcnbjmv></i> 实验室 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv> <i class="ri-contacts-line" data-astro-cid-tfcnbjmv></i> 友人 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv> <i class="ri-cup-line" data-astro-cid-tfcnbjmv></i> 关于 </a> </li> </ul>  </div> </div> </nav> <script>
  const headerEl = document.querySelector("#navbar-wrapper");
  const sentinalEl = document.querySelector("header");
  const handler = (entries) => {
    if (!entries[0].isIntersecting) {
      headerEl.classList.add("sticked");
    } else {
      headerEl.classList.remove("sticked");
    }
  };
  const observer = new window.IntersectionObserver(handler);
  observer.observe(sentinalEl);
</script>   <main data-astro-cid-4sn4zg3r> <section class="container mt-32" data-astro-cid-4sn4zg3r>  <h1 class="primary-color leading-relaxed" data-astro-cid-4sn4zg3r>LightOJ 1073 DNA Sequence 题解：字符串+状压 DP+字符串压位/搜索</h1> <p class="mt-4 secondary-color leading-relaxed" data-astro-cid-4sn4zg3r> <i class="ri-calendar-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>2018 年 10 月 04 日</span>   <br data-astro-cid-4sn4zg3r> <i class="ri-discuss-line" data-astro-cid-4sn4zg3r></i> <span data-astro-cid-4sn4zg3r>共 0 条评论</span>  </p> <hr class="my-8" data-astro-cid-4sn4zg3r> <p class="card p-2 my-8" data-astro-cid-4sn4zg3r>
⚙️ 全新博客前端仍在测试中。如果文章显示不正常，可以尝试访问<a href="https://blog.skywt.cn/posts/lightoj-1073" class="link underline" data-astro-cid-4sn4zg3r>原博客的这篇文章</a>。
</p> <article class="prose dark:prose-neutral dark:prose-invert max-w-none" data-astro-cid-4sn4zg3r> <h2>Description</h2><p>Link: <a href="http://lightoj.com/volume_showproblem.php?problem=1073">LightOJ 1873 DNA Sequence</a></p><blockquote><p>You are given a list of strings over the alphabet A (for adenine), C (cytosine), G (guanine), and T (thymine), and your task is to find the shortest string (which is typically not listed) that contains all given strings as substrings. If there are several such strings of shortest length, find the smallest in alphabetical/lexicographical order.</p><p>Time Limit:  4 second(s)<br>Memory Limit:  32 MB</p></blockquote><!--more--><h2>Input</h2><blockquote><p>Input starts with an integer  <strong>T (≤ 35)</strong>, denoting the number of test cases.</p><p>Each case starts with an integer denoting the number of strings  <strong>n (1 ≤ n ≤ 15)</strong> in a single line. Then these  <strong>n</strong>  strings  <strong>(1 ≤ length ≤ 100)</strong>  follow, one on each line, and they consist of the letters  <strong>'A', 'C', 'G'</strong>  and  <strong>'T'</strong>  only.</p></blockquote><h2>Output</h2><blockquote>For each case, print the case number and the shortest (and lexicographically smallest) string according to the description above.</blockquote><h2>Sample Input</h2><pre><code>2
2
TGCACA
CAT
3
TAC
ACT
CTA</code></pre><h2>Output for Sample Input</h2><pre><code>Case 1: TGCACAT
Case 2: ACTAC</code></pre><h2>Translation</h2><p>给你 N 个只包含 A、C、G、T 四种字符的字符串，你要找出一个最短的字符串 s，使得所有 N 个字符串都是 s 的子串。在满足 s 最短的前提下要使得 s 的字典序最小。</p><h2>Analysis</h2><h3>状压 DP？</h3><p>首先如果这些字符串有包含的情况，我们可以先直接把被包含的字符串全都去掉。</p><p>观察数据范围：$1\leqslant n\leqslant 15$，$n$ 非常小，可以考虑从状压 DP 入手。<br>由于题目要求我们首先答案的字符串长度最小，其次其字典序最小，我们自然想到定义 <code>F[i][j]</code> 表示状态为 i 并且最后一个字符串为 j 的最优字符串。</p><p>那么我们需要提前预处理一个东西：<code>p[i][j]</code> 表示第 i 个字符串后面接上第 j 个字符串，最长的重合串（即串 i 的后缀与串 j 的前缀的最长公共部分），例如 <code>ABCDE</code> 与 <code>CDEFG</code> 的结果是 <code>CDE</code>。</p><p>（在实际处理的时候，为了方便，我处理的 <code>forp[i][j]</code> 是第 j 个字符串去掉前面所述的“最长重合串”之后的串。即上述例子结果为 <code>FG</code>）</p><p>处理好这个东西就可以进行 DP 了，枚举状态转移就是在之前状态的字符串后面加上某个字符串，</p><h3>内存爆炸……</h3><p>但是仅仅这样是不行的，F 数组（string 类型）需要开到 <code>f[(1&lt;&lt;15)][15]</code>，而 <code>length&lt;=100</code>，而且这题内存限制是 32M！</p><p>仔细思考可以发现，DP 数组不需要 <code>F[i][j]</code>，只需要 <code>F[i]</code> 即可，再开个 <code>lst[i]</code> 记录 i 状态的最后一个字符串编号就行了。</p><h3>还是内存爆炸……</h3><p>这样仍然会 MLE……<del>（卡内存没素质）</del></p><p>那么接下来有两种办法：</p><p>方法之一是：注意到所有字符串里只有 4 种字符，我们可以把字符串进行压位，这样内存是可以接受，但是写起来非常麻烦（我的代码还 TLE 了……）……</p><p>方法二：仔细分析，发现我们单纯记录字符串是很盲目的，这些字符串都由那 15 个字符串拼接而来，这样记录白白多花了很多内存；其实可以把一个字符串由那些字符串拼接而成看成一个数列，那我们只要记录这个数列就可以了；</p><p>进一步发现，其实 <code>F[i][j]</code> 可以只记录长度，<code>pre[i][j]</code> 记录前驱（即 <code>F[i][j]</code> 这个状态是从哪里修正而来），这样只要最后进行一次搜索就可以得到整个数列。</p><h3>最小字典序</h3><p>这样还有个问题：怎样使得最终字符串<strong>字典序最小</strong>呢？<br>考虑对于一个状态 $D$，可以把所有能转移到它的状态向它建边。这样便形成了一个 DAG。所以最后只需要进行一次暴搜即可。</p><p>只要写个<del>近两百行的</del>状压 DP + 暴搜就可以了。</p><h2>Code</h2><pre><code class="lang-cpp">留坑待补……</code></pre> </article> <hr class="my-8" data-astro-cid-4sn4zg3r> <h2> <i class="ri-discuss-line"></i> 共 0 条评论 </h2>  <hr class="my-8"> <h2> <i class="ri-discuss-line"></i>
发表评论
</h2> <p class="primary-color card my-4 p-2">
🚧 新博客系统的评论功能仍在开发中，敬请期待。可以前往<a href="https://blog.skywt.cn/posts/lightoj-1073" class="link underline">原博客的这篇文章</a>底部评论区发表评论。
</p> </section> </main>  <footer class="mt-16 py-8 bg-gray-100 dark:bg-neutral-900"> <div class="wide-container secondary-color text-sm"> <div class="flex justify-between flex-wrap"> <div class="m-2"> <a href="/" class="link">SkyWT</a> <span>
/
<a href="/blog" class="link"> 博客</a> </span><span>
/
LightOJ 1073 DNA Sequence 题解：字符串+状压 DP+字符串压位/搜索 </span> </div> <div class="m-2"> <ul data-astro-cid-tfcnbjmv> <li data-astro-cid-tfcnbjmv> <a class="link" href="/" data-astro-cid-tfcnbjmv> 
主页
</a> </li> <li data-astro-cid-tfcnbjmv> <a class="link" href="/blog" data-astro-cid-tfcnbjmv>  博客 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/lab" data-astro-cid-tfcnbjmv>  实验室 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/friends" data-astro-cid-tfcnbjmv>  友人 </a> </li><li data-astro-cid-tfcnbjmv> <a class="link" href="/about" data-astro-cid-tfcnbjmv>  关于 </a> </li> </ul>  </div> </div> <hr class="my-4"> <div class="flex justify-between flex-wrap"> <p class="m-2">
&#169; 2017-2024 <a href="/" class="link">SkyWT</a>
|
<a href="/sitemap.xml" class="link">站点地图</a>
|
<a href="/friends" class="link">友情链接</a>
|
<a href="https://foreverblog.cn/go.html" class="link">虫洞</a> <!-- |
        <a href="https://github.com/Skywt2003/Daydreamer" class="link"
          >Daydreamer</a
        > --> </p> <div class="m-2"> <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" class="inline-block mx-1" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/cc.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/by.svg" data-astro-cid-h3ykra2n> <img class="icon" src="/cc/nc.svg" data-astro-cid-h3ykra2n>   </a>  <a href="https://notbyai.fyi" target="_blank" class="inline-block mx-1" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-light.svg" alt="Not By AI Badge" class="badge inline-block dark:hidden" data-astro-cid-hwbnc4sm> <img src="/not-by-ai-dark.svg" alt="Not By AI Badge" class="badge hidden dark:inline-block" data-astro-cid-hwbnc4sm> </a>  <a href="https://www.foreverblog.cn/" target="_blank" class="inline-block mx-1"> <img src="https://img.foreverblog.cn/logo_en_default.png" alt="Forever Blog Badage" class="inline-block h-4 grayscale"> </a> </div> </div> <div class="flex justify-between flex-wrap"> <p class="m-2"> <a href="https://beian.miit.gov.cn/" target="_blank" class="link">
浙 ICP 备 2021019606 号 - 1</a>
|
<a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33080202000472" target="_blank" class="link before:content-[url('/mps.png')] before:align-middle">
浙公网安备 33080202000472 号</a> </p> <p class="m-2"> <span class="align-middle">由</span> <a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" class="inline-block align-middle"> <img src="/upyun.png" class="h-6"> </a> <span class="align-middle">提供 CDN 加速、云存储服务</span> </p> </div> </div> </footer> </body></html> 