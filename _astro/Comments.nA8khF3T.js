import{p as d,_ as g}from"./hooks.module.VyOY6ch0.js";import{l as h,g as u}from"./preact.module.cCMnYM-D.js";var v=0;function e(n,a,o,s,m,i){var l,r,t={};for(r in a)r=="ref"?l=a[r]:t[r]=a[r];var c={type:n,props:t,key:o,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--v,__i:-1,__u:0,__source:m,__self:i};if(typeof n=="function"&&(l=n.defaultProps))for(r in l)t[r]===void 0&&(t[r]=l[r]);return h.vnode&&h.vnode(c),c}function f(n){function a(o){const s=new Date(o*1e3),m=s.getFullYear(),i=s.getMonth()+1,l=s.getDate(),r=s.getHours(),t=s.getMinutes();return`${m} 年 ${i} 月 ${l} 日 ${r}:${t}`}return e("div",{class:"primary-color my-4",children:[e("div",{class:"flex items-center",children:[e("img",{src:"https://gravatar.com/avatar/"+n.comment.mailHash,class:"rounded-full w-12 mr-2"}),e("div",{class:"m-2",children:[n.comment.url?e("a",{href:n.comment.url,class:"link",target:"_blank",children:e("h4",{children:n.comment.author})}):e("h4",{children:n.comment.author}),e("p",{class:"mt-1",children:a(n.comment.created)})]})]}),e("p",{class:"mt-2 break-all",children:n.comment.text}),e("div",{class:"ml-8",children:n.comment.children.map(o=>e(f,{comment:o}))})]})}function k(n){const[a,o]=d([]),[s,m]=d(!1),[i,l]=d(0);function r(t){let c=0;for(const _ of t)c++,c+=r(_.children);return c}return g(()=>{const t=new URL("https://blog.skywt.cn/api/comments");t.search=new URLSearchParams({page:"1",pageSize:"100",order:"desc",slug:n.slug}).toString(),fetch(t).then(c=>c.json()).then(c=>{o(c.data.dataSet),l(r(c.data.dataSet))}).catch(c=>{console.log("Error: ",c),m(!0)})},[]),e(u,{children:[s?e(u,{children:[e("h2",{children:[e("i",{class:"ri-discuss-line"})," 评论"]}),e("p",{class:"primary-color card my-4 p-2",children:["🚧 抱歉，获取评论失败。请前往",e("a",{href:n.permalink,class:"link underline",children:"原博客的这篇文章"}),"底部评论区查看评论。"]})]}):e(u,{children:[e("h2",{children:[e("i",{class:"ri-discuss-line"}),i>0?" 共 "+i+" 条评论":" 暂无评论"]}),a.map(t=>e(f,{comment:t}))]}),e("hr",{class:"my-8"}),e("h2",{children:[e("i",{class:"ri-discuss-line"})," 发表评论"]}),e("p",{class:"primary-color card my-4 p-2",children:["🚧 新博客系统的评论功能仍在开发中，敬请期待。可以前往",e("a",{href:n.permalink,class:"link underline",children:"原博客的这篇文章"}),"底部评论区发表评论。"]})]})}export{k as default};
