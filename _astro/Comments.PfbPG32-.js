import{r as N}from"./index.LFf77hJu.js";var L=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ue(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function fe(e){if(e.__esModule)return e;var i=e.default;if(typeof i=="function"){var f=function n(){return this instanceof n?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};f.prototype=i.prototype}else f={};return Object.defineProperty(f,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var _=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(f,n,_.get?_:{enumerable:!0,get:function(){return e[n]}})}),f}var X={exports:{}},K={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var de=N,he=Symbol.for("react.element"),me=Symbol.for("react.fragment"),pe=Object.prototype.hasOwnProperty,ye=de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ve={key:!0,ref:!0,__self:!0,__source:!0};function Z(e,i,f){var n,_={},p=null,v=null;f!==void 0&&(p=""+f),i.key!==void 0&&(p=""+i.key),i.ref!==void 0&&(v=i.ref);for(n in i)pe.call(i,n)&&!ve.hasOwnProperty(n)&&(_[n]=i[n]);if(e&&e.defaultProps)for(n in i=e.defaultProps,i)_[n]===void 0&&(_[n]=i[n]);return{$$typeof:he,type:e,key:p,ref:v,props:_,_owner:ye.current}}K.Fragment=me;K.jsx=Z;K.jsxs=Z;X.exports=K;var h=X.exports;/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var ee=_e,J=xe,ge=Object.prototype.toString,q=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function _e(e,i){if(typeof e!="string")throw new TypeError("argument str must be a string");for(var f={},n=i||{},_=n.decode||we,p=0;p<e.length;){var v=e.indexOf("=",p);if(v===-1)break;var S=e.indexOf(";",p);if(S===-1)S=e.length;else if(S<v){p=e.lastIndexOf(";",v-1)+1;continue}var C=e.slice(p,v).trim();if(f[C]===void 0){var o=e.slice(v+1,S).trim();o.charCodeAt(0)===34&&(o=o.slice(1,-1)),f[C]=Ce(o,_)}p=S+1}return f}function xe(e,i,f){var n=f||{},_=n.encode||Se;if(typeof _!="function")throw new TypeError("option encode is invalid");if(!q.test(e))throw new TypeError("argument name is invalid");var p=_(i);if(p&&!q.test(p))throw new TypeError("argument val is invalid");var v=e+"="+p;if(n.maxAge!=null){var S=n.maxAge-0;if(isNaN(S)||!isFinite(S))throw new TypeError("option maxAge is invalid");v+="; Max-Age="+Math.floor(S)}if(n.domain){if(!q.test(n.domain))throw new TypeError("option domain is invalid");v+="; Domain="+n.domain}if(n.path){if(!q.test(n.path))throw new TypeError("option path is invalid");v+="; Path="+n.path}if(n.expires){var C=n.expires;if(!be(C)||isNaN(C.valueOf()))throw new TypeError("option expires is invalid");v+="; Expires="+C.toUTCString()}if(n.httpOnly&&(v+="; HttpOnly"),n.secure&&(v+="; Secure"),n.partitioned&&(v+="; Partitioned"),n.priority){var o=typeof n.priority=="string"?n.priority.toLowerCase():n.priority;switch(o){case"low":v+="; Priority=Low";break;case"medium":v+="; Priority=Medium";break;case"high":v+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(n.sameSite){var T=typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite;switch(T){case!0:v+="; SameSite=Strict";break;case"lax":v+="; SameSite=Lax";break;case"strict":v+="; SameSite=Strict";break;case"none":v+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return v}function we(e){return e.indexOf("%")!==-1?decodeURIComponent(e):e}function Se(e){return encodeURIComponent(e)}function be(e){return ge.call(e)==="[object Date]"||e instanceof Date}function Ce(e,i){try{return i(e)}catch{return e}}function je(){const e=typeof global>"u"?void 0:global.TEST_HAS_DOCUMENT_COOKIE;return typeof e=="boolean"?e:typeof document=="object"&&typeof document.cookie=="string"}function ke(e){return typeof e=="string"?ee(e):typeof e=="object"&&e!==null?e:{}}function V(e,i={}){const f=Oe(e);if(!i.doNotParse)try{return JSON.parse(f)}catch{}return e}function Oe(e){return e&&e[0]==="j"&&e[1]===":"?e.substr(2):e}class te{constructor(i,f={}){this.changeListeners=[],this.HAS_DOCUMENT_COOKIE=!1,this.update=()=>{if(!this.HAS_DOCUMENT_COOKIE)return;const _=this.cookies;this.cookies=ee(document.cookie),this._checkChanges(_)};const n=typeof document>"u"?"":document.cookie;this.cookies=ke(i||n),this.defaultSetOptions=f,this.HAS_DOCUMENT_COOKIE=je()}_emitChange(i){for(let f=0;f<this.changeListeners.length;++f)this.changeListeners[f](i)}_checkChanges(i){new Set(Object.keys(i).concat(Object.keys(this.cookies))).forEach(n=>{i[n]!==this.cookies[n]&&this._emitChange({name:n,value:V(this.cookies[n])})})}_startPolling(){this.pollingInterval=setInterval(this.update,300)}_stopPolling(){this.pollingInterval&&clearInterval(this.pollingInterval)}get(i,f={}){return f.doNotUpdate||this.update(),V(this.cookies[i],f)}getAll(i={}){i.doNotUpdate||this.update();const f={};for(let n in this.cookies)f[n]=V(this.cookies[n],i);return f}set(i,f,n){n?n=Object.assign(Object.assign({},this.defaultSetOptions),n):n=this.defaultSetOptions;const _=typeof f=="string"?f:JSON.stringify(f);this.cookies=Object.assign(Object.assign({},this.cookies),{[i]:_}),this.HAS_DOCUMENT_COOKIE&&(document.cookie=J(i,_,n)),this._emitChange({name:i,value:f,options:n})}remove(i,f){const n=f=Object.assign(Object.assign(Object.assign({},this.defaultSetOptions),f),{expires:new Date(1970,1,1,0,0,1),maxAge:0});this.cookies=Object.assign({},this.cookies),delete this.cookies[i],this.HAS_DOCUMENT_COOKIE&&(document.cookie=J(i,"",n)),this._emitChange({name:i,value:void 0,options:f})}addChangeListener(i){this.changeListeners.push(i),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===1&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.addEventListener("change",this.update):this._startPolling())}removeChangeListener(i){const f=this.changeListeners.indexOf(i);f>=0&&this.changeListeners.splice(f,1),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===0&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.removeEventListener("change",this.update):this._stopPolling())}}const re=N.createContext(new te),{Provider:Ee,Consumer:We}=re;class Ne extends N.Component{constructor(i){super(i),i.cookies?this.cookies=i.cookies:this.cookies=new te(void 0,i.defaultSetOptions)}render(){return N.createElement(Ee,{value:this.cookies},this.props.children)}}var ne={exports:{}},j={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y;function Te(){if(Y)return j;Y=1;var e=typeof Symbol=="function"&&Symbol.for,i=e?Symbol.for("react.element"):60103,f=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,_=e?Symbol.for("react.strict_mode"):60108,p=e?Symbol.for("react.profiler"):60114,v=e?Symbol.for("react.provider"):60109,S=e?Symbol.for("react.context"):60110,C=e?Symbol.for("react.async_mode"):60111,o=e?Symbol.for("react.concurrent_mode"):60111,T=e?Symbol.for("react.forward_ref"):60112,x=e?Symbol.for("react.suspense"):60113,k=e?Symbol.for("react.suspense_list"):60120,O=e?Symbol.for("react.memo"):60115,w=e?Symbol.for("react.lazy"):60116,m=e?Symbol.for("react.block"):60121,y=e?Symbol.for("react.fundamental"):60117,b=e?Symbol.for("react.responder"):60118,r=e?Symbol.for("react.scope"):60119;function s(t){if(typeof t=="object"&&t!==null){var g=t.$$typeof;switch(g){case i:switch(t=t.type,t){case C:case o:case n:case p:case _:case x:return t;default:switch(t=t&&t.$$typeof,t){case S:case T:case w:case O:case v:return t;default:return g}}case f:return g}}}function d(t){return s(t)===o}return j.AsyncMode=C,j.ConcurrentMode=o,j.ContextConsumer=S,j.ContextProvider=v,j.Element=i,j.ForwardRef=T,j.Fragment=n,j.Lazy=w,j.Memo=O,j.Portal=f,j.Profiler=p,j.StrictMode=_,j.Suspense=x,j.isAsyncMode=function(t){return d(t)||s(t)===C},j.isConcurrentMode=d,j.isContextConsumer=function(t){return s(t)===S},j.isContextProvider=function(t){return s(t)===v},j.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===i},j.isForwardRef=function(t){return s(t)===T},j.isFragment=function(t){return s(t)===n},j.isLazy=function(t){return s(t)===w},j.isMemo=function(t){return s(t)===O},j.isPortal=function(t){return s(t)===f},j.isProfiler=function(t){return s(t)===p},j.isStrictMode=function(t){return s(t)===_},j.isSuspense=function(t){return s(t)===x},j.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===n||t===o||t===p||t===_||t===x||t===k||typeof t=="object"&&t!==null&&(t.$$typeof===w||t.$$typeof===O||t.$$typeof===v||t.$$typeof===S||t.$$typeof===T||t.$$typeof===y||t.$$typeof===b||t.$$typeof===r||t.$$typeof===m)},j.typeOf=s,j}ne.exports=Te();var Re=ne.exports,oe=Re,Be={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},$e={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},ie={};ie[oe.ForwardRef]=Be;ie[oe.Memo]=$e;function Pe(){return typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"}function se(e){const i=N.useContext(re);if(!i)throw new Error("Missing <CookiesProvider>");const[f,n]=N.useState(()=>i.getAll({doNotUpdate:!0}));Pe()&&N.useLayoutEffect(()=>{function S(){const C=i.getAll({doNotUpdate:!0});Me(e||null,C,f)&&n(C)}return i.addChangeListener(S),()=>{i.removeChangeListener(S)}},[i,f]);const _=N.useMemo(()=>i.set.bind(i),[i]),p=N.useMemo(()=>i.remove.bind(i),[i]),v=N.useMemo(()=>i.update.bind(i),[i]);return[f,_,p,v]}function Me(e,i,f){if(!e)return!0;for(let n of e)if(i[n]!==f[n])return!0;return!1}function ae(e){const[i,f]=N.useState(""),[n,_]=N.useState(""),[p,v]=N.useState(""),[S,C]=N.useState(""),[o,T]=N.useState(!0),[x,k,O]=se(["author","email","url"]);return N.useEffect(()=>{x.author&&(f(x.author),T(!1)),x.email&&_(x.email),x.url&&v(x.url)},[]),h.jsxs(h.Fragment,{children:[e.selected.coid!==0&&h.jsxs("div",{className:"mt-4 flex justify-between",children:[h.jsxs("p",{className:"primary-color font-bold",children:[h.jsx("i",{className:"ri-reply-line"})," 回复 @",e.selected.author," ","的评论："]}),h.jsx("p",{children:h.jsx("span",{className:"link",onClick:()=>e.clearReply(),children:"取消回复"})})]}),h.jsxs("p",{className:"mt-4 primary-color card p-2",children:[h.jsx("i",{className:"ri-information-line"})," ",h.jsx("b",{children:"所有评论都将经过博主审核。"}),"请勿填写无意义邮箱或发表无关评论、广告等，否则会被视为垃圾评论。",h.jsx("br",{}),"评论提交组件是最近刚写的，如果遇到 bug 欢迎向博主反馈～"]}),h.jsxs("form",{onSubmit:w=>{e.handleSubmit(i,n,p,S),k("author",i),k("email",n),k("url",p),C(""),w.preventDefault()},className:"mt-4 grid gap-4 grid-cols-1 sm:grid-cols-3 relative",children:[h.jsx("input",{placeholder:"你的名字",type:"text",required:!0,value:i,onChange:w=>{f(w.target.value)}}),h.jsx("input",{placeholder:"邮箱",type:"email",required:!0,value:n,onChange:w=>{_(w.target.value)}}),h.jsx("input",{placeholder:"网址",type:"url",value:p,onChange:w=>{v(w.target.value)}}),h.jsx("textarea",{rows:8,className:"sm:col-span-3",placeholder:"说点什么吧……",required:!0,value:S,onChange:w=>{C(w.target.value)}}),h.jsx("button",{type:"submit",className:"sm:col-span-3",disabled:e.sending,children:e.sending?"提交中……":"提交"})]}),o&&h.jsxs("p",{className:"mt-4 secondary-color text-sm leading-normal",children:["提交评论即表明你同意本网站使用 Cookie，并允许本站在后台记录你的邮箱、IP 地址等必要信息。",h.jsx("br",{}),"（提交一次评论后，本提示将不再展示）"]})]})}function ce(e){function i(f){const n=new Date(f*1e3),_=n.getFullYear(),p=n.getMonth()+1,v=n.getDate(),S=n.getHours().toString().padStart(2,"0"),C=n.getMinutes().toString().padStart(2,"0");return`${_} 年 ${p} 月 ${v} 日 ${S}:${C}`}return h.jsxs("div",{className:"primary-color my-4",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx("img",{src:"https://gravatar.com/avatar/"+e.comment.mailHash,className:"rounded-full w-12 mr-2"}),h.jsxs("div",{className:"m-2",children:[e.comment.url?h.jsx("a",{href:e.comment.url,className:"link",target:"_blank",children:h.jsx("h4",{children:e.comment.author})}):h.jsx("h4",{children:e.comment.author}),h.jsxs("p",{className:"mt-1",children:[h.jsx("span",{className:"secondary-color",children:i(e.comment.created)}),e.comment.status==="approved"?h.jsxs("span",{className:"link ml-2 primary-color",onClick:()=>{e.handleReply(e.comment.coid,e.comment.author)},children:[h.jsx("i",{className:"ri-reply-line"})," 回复"]}):h.jsxs("span",{className:"ml-2 primary-color",children:[h.jsx("i",{className:"ri-admin-line"})," 待审核"]})]})]})]}),h.jsx("p",{className:"mt-2 break-all",children:e.comment.text}),e.comment.coid===e.selected.coid&&h.jsx(ae,{selected:e.selected,clearReply:()=>{e.handleReply(0,"")},handleSubmit:e.handleSubmit,sending:e.sending}),h.jsx("div",{className:"ml-8",children:e.comment.children.map(f=>h.jsx(ce,{selected:e.selected,comment:f,handleReply:e.handleReply,handleSubmit:e.handleSubmit,sending:e.sending},f.coid))})]})}var le={exports:{}};function Le(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var G={exports:{}};const De={},Ae=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"})),Ie=fe(Ae);var Q;function He(){return Q||(Q=1,function(e,i){(function(f,n){e.exports=n()})(L,function(){var f=f||function(n,_){var p;if(typeof window<"u"&&window.crypto&&(p=window.crypto),typeof self<"u"&&self.crypto&&(p=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(p=globalThis.crypto),!p&&typeof window<"u"&&window.msCrypto&&(p=window.msCrypto),!p&&typeof L<"u"&&L.crypto&&(p=L.crypto),!p&&typeof Le=="function")try{p=Ie}catch{}var v=function(){if(p){if(typeof p.getRandomValues=="function")try{return p.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof p.randomBytes=="function")try{return p.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},S=Object.create||function(){function r(){}return function(s){var d;return r.prototype=s,d=new r,r.prototype=null,d}}(),C={},o=C.lib={},T=o.Base=function(){return{extend:function(r){var s=S(this);return r&&s.mixIn(r),(!s.hasOwnProperty("init")||this.init===s.init)&&(s.init=function(){s.$super.init.apply(this,arguments)}),s.init.prototype=s,s.$super=this,s},create:function(){var r=this.extend();return r.init.apply(r,arguments),r},init:function(){},mixIn:function(r){for(var s in r)r.hasOwnProperty(s)&&(this[s]=r[s]);r.hasOwnProperty("toString")&&(this.toString=r.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),x=o.WordArray=T.extend({init:function(r,s){r=this.words=r||[],s!=_?this.sigBytes=s:this.sigBytes=r.length*4},toString:function(r){return(r||O).stringify(this)},concat:function(r){var s=this.words,d=r.words,t=this.sigBytes,g=r.sigBytes;if(this.clamp(),t%4)for(var E=0;E<g;E++){var B=d[E>>>2]>>>24-E%4*8&255;s[t+E>>>2]|=B<<24-(t+E)%4*8}else for(var R=0;R<g;R+=4)s[t+R>>>2]=d[R>>>2];return this.sigBytes+=g,this},clamp:function(){var r=this.words,s=this.sigBytes;r[s>>>2]&=4294967295<<32-s%4*8,r.length=n.ceil(s/4)},clone:function(){var r=T.clone.call(this);return r.words=this.words.slice(0),r},random:function(r){for(var s=[],d=0;d<r;d+=4)s.push(v());return new x.init(s,r)}}),k=C.enc={},O=k.Hex={stringify:function(r){for(var s=r.words,d=r.sigBytes,t=[],g=0;g<d;g++){var E=s[g>>>2]>>>24-g%4*8&255;t.push((E>>>4).toString(16)),t.push((E&15).toString(16))}return t.join("")},parse:function(r){for(var s=r.length,d=[],t=0;t<s;t+=2)d[t>>>3]|=parseInt(r.substr(t,2),16)<<24-t%8*4;return new x.init(d,s/2)}},w=k.Latin1={stringify:function(r){for(var s=r.words,d=r.sigBytes,t=[],g=0;g<d;g++){var E=s[g>>>2]>>>24-g%4*8&255;t.push(String.fromCharCode(E))}return t.join("")},parse:function(r){for(var s=r.length,d=[],t=0;t<s;t++)d[t>>>2]|=(r.charCodeAt(t)&255)<<24-t%4*8;return new x.init(d,s)}},m=k.Utf8={stringify:function(r){try{return decodeURIComponent(escape(w.stringify(r)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(r){return w.parse(unescape(encodeURIComponent(r)))}},y=o.BufferedBlockAlgorithm=T.extend({reset:function(){this._data=new x.init,this._nDataBytes=0},_append:function(r){typeof r=="string"&&(r=m.parse(r)),this._data.concat(r),this._nDataBytes+=r.sigBytes},_process:function(r){var s,d=this._data,t=d.words,g=d.sigBytes,E=this.blockSize,B=E*4,R=g/B;r?R=n.ceil(R):R=n.max((R|0)-this._minBufferSize,0);var $=R*E,M=n.min($*4,g);if($){for(var P=0;P<$;P+=E)this._doProcessBlock(t,P);s=t.splice(0,$),d.sigBytes-=M}return new x.init(s,M)},clone:function(){var r=T.clone.call(this);return r._data=this._data.clone(),r},_minBufferSize:0});o.Hasher=y.extend({cfg:T.extend(),init:function(r){this.cfg=this.cfg.extend(r),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(r){return this._append(r),this._process(),this},finalize:function(r){r&&this._append(r);var s=this._doFinalize();return s},blockSize:16,_createHelper:function(r){return function(s,d){return new r.init(d).finalize(s)}},_createHmacHelper:function(r){return function(s,d){return new b.HMAC.init(r,d).finalize(s)}}});var b=C.algo={};return C}(Math);return f})}(G)),G.exports}(function(e,i){(function(f,n){e.exports=n(He())})(L,function(f){return function(n){var _=f,p=_.lib,v=p.WordArray,S=p.Hasher,C=_.algo,o=[];(function(){for(var m=0;m<64;m++)o[m]=n.abs(n.sin(m+1))*4294967296|0})();var T=C.MD5=S.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(m,y){for(var b=0;b<16;b++){var r=y+b,s=m[r];m[r]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360}var d=this._hash.words,t=m[y+0],g=m[y+1],E=m[y+2],B=m[y+3],R=m[y+4],$=m[y+5],M=m[y+6],P=m[y+7],D=m[y+8],A=m[y+9],I=m[y+10],H=m[y+11],U=m[y+12],F=m[y+13],z=m[y+14],W=m[y+15],a=d[0],c=d[1],l=d[2],u=d[3];a=x(a,c,l,u,t,7,o[0]),u=x(u,a,c,l,g,12,o[1]),l=x(l,u,a,c,E,17,o[2]),c=x(c,l,u,a,B,22,o[3]),a=x(a,c,l,u,R,7,o[4]),u=x(u,a,c,l,$,12,o[5]),l=x(l,u,a,c,M,17,o[6]),c=x(c,l,u,a,P,22,o[7]),a=x(a,c,l,u,D,7,o[8]),u=x(u,a,c,l,A,12,o[9]),l=x(l,u,a,c,I,17,o[10]),c=x(c,l,u,a,H,22,o[11]),a=x(a,c,l,u,U,7,o[12]),u=x(u,a,c,l,F,12,o[13]),l=x(l,u,a,c,z,17,o[14]),c=x(c,l,u,a,W,22,o[15]),a=k(a,c,l,u,g,5,o[16]),u=k(u,a,c,l,M,9,o[17]),l=k(l,u,a,c,H,14,o[18]),c=k(c,l,u,a,t,20,o[19]),a=k(a,c,l,u,$,5,o[20]),u=k(u,a,c,l,I,9,o[21]),l=k(l,u,a,c,W,14,o[22]),c=k(c,l,u,a,R,20,o[23]),a=k(a,c,l,u,A,5,o[24]),u=k(u,a,c,l,z,9,o[25]),l=k(l,u,a,c,B,14,o[26]),c=k(c,l,u,a,D,20,o[27]),a=k(a,c,l,u,F,5,o[28]),u=k(u,a,c,l,E,9,o[29]),l=k(l,u,a,c,P,14,o[30]),c=k(c,l,u,a,U,20,o[31]),a=O(a,c,l,u,$,4,o[32]),u=O(u,a,c,l,D,11,o[33]),l=O(l,u,a,c,H,16,o[34]),c=O(c,l,u,a,z,23,o[35]),a=O(a,c,l,u,g,4,o[36]),u=O(u,a,c,l,R,11,o[37]),l=O(l,u,a,c,P,16,o[38]),c=O(c,l,u,a,I,23,o[39]),a=O(a,c,l,u,F,4,o[40]),u=O(u,a,c,l,t,11,o[41]),l=O(l,u,a,c,B,16,o[42]),c=O(c,l,u,a,M,23,o[43]),a=O(a,c,l,u,A,4,o[44]),u=O(u,a,c,l,U,11,o[45]),l=O(l,u,a,c,W,16,o[46]),c=O(c,l,u,a,E,23,o[47]),a=w(a,c,l,u,t,6,o[48]),u=w(u,a,c,l,P,10,o[49]),l=w(l,u,a,c,z,15,o[50]),c=w(c,l,u,a,$,21,o[51]),a=w(a,c,l,u,U,6,o[52]),u=w(u,a,c,l,B,10,o[53]),l=w(l,u,a,c,I,15,o[54]),c=w(c,l,u,a,g,21,o[55]),a=w(a,c,l,u,D,6,o[56]),u=w(u,a,c,l,W,10,o[57]),l=w(l,u,a,c,M,15,o[58]),c=w(c,l,u,a,F,21,o[59]),a=w(a,c,l,u,R,6,o[60]),u=w(u,a,c,l,H,10,o[61]),l=w(l,u,a,c,E,15,o[62]),c=w(c,l,u,a,A,21,o[63]),d[0]=d[0]+a|0,d[1]=d[1]+c|0,d[2]=d[2]+l|0,d[3]=d[3]+u|0},_doFinalize:function(){var m=this._data,y=m.words,b=this._nDataBytes*8,r=m.sigBytes*8;y[r>>>5]|=128<<24-r%32;var s=n.floor(b/4294967296),d=b;y[(r+64>>>9<<4)+15]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360,y[(r+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,m.sigBytes=(y.length+1)*4,this._process();for(var t=this._hash,g=t.words,E=0;E<4;E++){var B=g[E];g[E]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360}return t},clone:function(){var m=S.clone.call(this);return m._hash=this._hash.clone(),m}});function x(m,y,b,r,s,d,t){var g=m+(y&b|~y&r)+s+t;return(g<<d|g>>>32-d)+y}function k(m,y,b,r,s,d,t){var g=m+(y&r|b&~r)+s+t;return(g<<d|g>>>32-d)+y}function O(m,y,b,r,s,d,t){var g=m+(y^b^r)+s+t;return(g<<d|g>>>32-d)+y}function w(m,y,b,r,s,d,t){var g=m+(b^(y|~r))+s+t;return(g<<d|g>>>32-d)+y}_.MD5=S._createHelper(T),_.HmacMD5=S._createHmacHelper(T)}(Math),f.MD5})})(le);var Ue=le.exports;const Fe=ue(Ue);function qe(e){const[i,f]=N.useState([]),[n,_]=N.useState(!1),[p,v]=N.useState(0),[S,C]=N.useState({coid:0,author:""}),[o,T]=N.useState(!1),[x,k,O]=se(["author","email","6b3ebcda94b5d7402440f389500dd314__typecho_remember_author","6b3ebcda94b5d7402440f389500dd314__typecho_remember_mail"]);function w(m,y,b,r){if(o===!0)return;T(!0);const s=new URL("https://blog.skywt.cn/api/comment"),d={slug:e.slug,text:r,author:m,mail:y,url:b,token:""};S.coid!==0&&(d.parent=S.coid),fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).then(t=>{if(t.ok===!1)throw Error("HTTP Error "+t.status+" "+t.statusText);return t.json()}).then(t=>{const g={coid:Math.floor(Math.random()*1e4)+1e4,parent:S.coid,cid:-1,created:Math.floor(Date.now()/1e3),author:m,url:b,text:r,status:"wating",mailHash:Fe(y).toString(),children:[]};f([...i,g]),T(!1),C({coid:0,author:""})}).catch(t=>{console.log("Error: ",t),alert("抱歉，评论发送失败。"),T(!1)})}return N.useEffect(()=>{function m(b){let r=0;return b.forEach(s=>{r++,r+=m(s.children)}),r}const y=new URL("https://blog.skywt.cn/api/comments");y.search=new URLSearchParams({page:"1",pageSize:"100",order:"asc",slug:e.slug}).toString(),k("6b3ebcda94b5d7402440f389500dd314__typecho_remember_author",x.author),k("6b3ebcda94b5d7402440f389500dd314__typecho_remember_mail",x.email),fetch(y,{method:"GET",credentials:"include"}).then(b=>b.json()).then(b=>{f(b.data.dataSet),v(m(b.data.dataSet))}).catch(b=>{console.log("Error: ",b),_(!0)})},[]),h.jsxs(Ne,{defaultSetOptions:{path:"/",maxAge:2592e3},children:[n?h.jsxs(h.Fragment,{children:[h.jsxs("h2",{children:[h.jsx("i",{className:"ri-discuss-line"})," 评论"]}),h.jsxs("p",{className:"primary-color card my-4 p-2",children:["🚧 抱歉，获取评论失败。请前往",h.jsx("a",{href:e.permalink,className:"link underline",children:"原博客的这篇文章"}),"底部评论区查看评论。"]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("h2",{children:[h.jsx("i",{className:"ri-discuss-line"}),p>0?" 共 "+p+" 条评论":" 暂无评论"]}),i.map(m=>h.jsx(ce,{comment:m,selected:S,handleReply:(y,b)=>{C({coid:y,author:b})},handleSubmit:w,sending:o},m.coid))]}),h.jsx("hr",{className:"my-8"}),h.jsxs("h2",{children:[h.jsx("i",{className:"ri-discuss-line"})," 发表新的评论"]}),S.coid===0?h.jsx(ae,{selected:S,clearReply:()=>{C({coid:0,author:""})},handleSubmit:w,sending:o}):h.jsx("div",{className:"mt-4",children:h.jsx("span",{className:"link underline primary-color",onClick:()=>{C({coid:0,author:""})},children:"取消评论回复"})})]})}export{qe as default};
